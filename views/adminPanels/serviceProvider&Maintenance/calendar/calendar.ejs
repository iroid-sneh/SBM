<style>
    /* Optional: Smooth scroll and selection effects */
    #calendar-grid div:hover {
        background-color: #dce9f9;
    }
</style>

<div class="bg-[#f7f6f5] rounded-[100px] flex-1 justify-center items-center">
    <!-- Breadcrumb -->
    <div class="flex p-8 ml-10 items-center space-x-4">
        <h3 class="text-gray-600 text-lg">Calendar</h3>
        <div class="w-px h-7 bg-gray-300"></div>
        <svg
            width="17"
            height="16"
            viewBox="0 0 17 16"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
        >
            <path
                d="M14.1092 2.25781H12.6953V3.1404C12.6965 3.21679 12.6675 3.29056 12.6146 3.34566C12.5617 3.40076 12.4891 3.43273 12.4127 3.4346H11.849C11.7726 3.43273 11.7001 3.40076 11.6471 3.34566C11.5942 3.29056 11.5652 3.21679 11.5664 3.1404V2.25781H4.77594V3.1404C4.77716 3.21679 4.74816 3.29056 4.69524 3.34566C4.64232 3.40076 4.56978 3.43273 4.49341 3.4346H3.9277C3.85133 3.43273 3.77878 3.40076 3.72587 3.34566C3.67295 3.29056 3.64395 3.21679 3.64516 3.1404V2.25781H2.23056C1.84842 2.26666 1.48528 2.42629 1.22038 2.70186C0.95549 2.97744 0.810339 3.3466 0.816601 3.7288V13.7295C0.810339 14.1117 0.95549 14.4809 1.22038 14.7565C1.48528 15.0321 1.84842 15.1917 2.23056 15.2005H14.1092C14.4914 15.1917 14.8545 15.0321 15.1194 14.7565C15.3843 14.4809 15.5295 14.1117 15.5232 13.7295V3.7288C15.5295 3.3466 15.3843 2.97744 15.1194 2.70186C14.8545 2.42629 14.4914 2.26666 14.1092 2.25781ZM14.3918 13.2882C14.3949 13.4793 14.3223 13.6639 14.1899 13.8017C14.0574 13.9395 13.8759 14.0193 13.6848 14.0237H2.65501C2.46393 14.0193 2.28237 13.9395 2.14992 13.8017C2.01747 13.6639 1.9449 13.4793 1.94803 13.2882V6.67011C1.94681 6.59373 1.97581 6.51996 2.02873 6.46485C2.08165 6.40975 2.15419 6.37779 2.23056 6.37592H14.1092C14.1856 6.37779 14.2581 6.40975 14.3111 6.46485C14.364 6.51996 14.393 6.59373 14.3918 6.67011V13.2882Z"
                fill="#163F75"
            />
            <path
                d="M5.03615 1.16496C5.03581 1.06848 4.99733 0.976048 4.9291 0.907825C4.86088 0.839602 4.76845 0.801123 4.67197 0.800781H3.94295C3.84636 0.800952 3.75376 0.839355 3.6854 0.907597C3.61704 0.975839 3.57847 1.06837 3.57812 1.16496V2.25816H5.03615V1.16496Z"
                fill="#163F75"
            />
            <path
                d="M12.7621 1.16496C12.7617 1.06848 12.7232 0.976048 12.655 0.907825C12.5868 0.839602 12.4944 0.801123 12.3979 0.800781H11.6689C11.5723 0.801124 11.4797 0.839692 11.4115 0.908055C11.3433 0.976418 11.3049 1.06902 11.3047 1.16561V2.25816H12.7621V1.16496Z"
                fill="#163F75"
            />
        </svg>
        <svg width="24" height="16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
                d="M5.668 3.335L10.335 8 5.668 12.668M13.668 3.335L18.335 8 13.668 12.668"
                stroke="black"
                stroke-width="1.2"
                stroke-linecap="round"
                stroke-linejoin="round"
            />
        </svg>
        <h3 class="text-[#163F75] text-lg">Date</h3>
    </div>

    <!-- Main Calendar Content -->
    <div class="bg-white rounded-2xl flex w-[1280px] mx-auto shadow-lg mb-8">
        <!-- Left: Upcoming Events -->
        <div class="w-1/4 p-6 border-r">
            <h2 class="text-[#163F75] font-semibold text-xl mb-4">Upcoming</h2>
            <div id="event-list" class="space-y-4 overflow-y-auto max-h-[700px] pr-2">
                <!-- Event items will be dynamically inserted here -->
            </div>
        </div>

        <!-- Right: Monthly Calendar -->
        <div class="w-2/3 p-6">
            <div class="flex justify-between items-center mb-4">
                <button id="prev-month" class="text-sm text-[#163F75] flex items-center gap-1">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path
                            d="M12.918 4.16536L7.08464 9.9987L12.918 15.832"
                            stroke="#163F75"
                            stroke-width="1.6"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                        />
                    </svg>
                    <span id="prev-month-name" class="prev-month-name text-sm"></span>
                </button>

                <h2 id="current-month-year" class="text-xl font-bold text-[#163F75]">Loading...</h2>

                <button id="next-month" class="text-sm text-[#163F75] flex items-center gap-1">
                    <span id="next-month-name" class="next-month-name text-sm"></span>
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path
                            d="M7.08203 4.16536L12.9154 9.9987L7.08203 15.832"
                            stroke="#163F75"
                            stroke-width="1.6"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                        />
                    </svg>
                </button>
            </div>
            <div class="grid grid-cols-7 gap-4 text-center">
                <div class="font-semibold text-gray-500">Sun</div>
                <div class="font-semibold text-gray-500">Mon</div>
                <div class="font-semibold text-gray-500">Tue</div>
                <div class="font-semibold text-gray-500">Wed</div>
                <div class="font-semibold text-gray-500">Thu</div>
                <div class="font-semibold text-gray-500">Fri</div>
                <div class="font-semibold text-gray-500">Sat</div>
            </div>
            <div id="calendar-grid" class="grid grid-cols-6 gap-6 p-4 mt-2">
                <!-- Calendar cells will be dynamically generated here -->
            </div>
            <!-- Day Timeline View (initially hidden) -->
            <div id="day-timeline-view" class="hidden mt-6">
                <div class="flex justify-between items-center mb-6">
                    <button onclick="goToPreviousDay()" class="text-sm text-blue-600 chevron-left">
                        Previous Day
                    </button>
                    <h2 class="text-xl font-bold text-[#1e3a8a]" id="current-day-title"></h2>
                    <button onclick="goToNextDay()" class="text-sm text-blue-600 chevron-right">
                        Next Day
                    </button>
                </div>
                <button onclick="goBackToCalendar()" class="mb-4 text-sm text-[#163F75] underline">
                    ‚Üê Back to Calendar
                </button>
                <div
                    class="relative border-t border-gray-200"
                    style="min-height: 600px"
                    id="timeline-container"
                >
                    <!-- Time slots and events will be rendered here -->
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const calendarGrid = document.getElementById("calendar-grid");
    const monthYearLabel = document.getElementById("current-month-year");
    const prevBtn = document.getElementById("prev-month");
    const nextBtn = document.getElementById("next-month");
    const prevMonthName = document.getElementById("prev-month-name");
    const nextMonthName = document.getElementById("next-month-name");

    let currentDate = new Date();

    function renderCalendar(date) {
        const year = date.getFullYear();
        const month = date.getMonth();

        const firstDayOfMonth = new Date(year, month, 1);
        const lastDayOfMonth = new Date(year, month + 1, 0);
        const daysInMonth = lastDayOfMonth.getDate();

        const startDay = firstDayOfMonth.getDay(); // Sunday = 0
        const totalCells = 36;

        // Update header
        monthYearLabel.textContent = date.toLocaleString("default", {
            month: "long",
            year: "numeric",
        });

        const prevDate = new Date(date);
        prevDate.setMonth(month - 1);
        prevMonthName.textContent = prevDate.toLocaleString("default", { month: "long" });

        const nextDate = new Date(date);
        nextDate.setMonth(month + 1);
        nextMonthName.textContent = nextDate.toLocaleString("default", { month: "long" });

        // Clear calendar
        calendarGrid.innerHTML = "";

        // Previous month's days
        const prevMonthLastDay = new Date(year, month, 0).getDate();
        for (let i = startDay - 1; i >= 0; i--) {
            const day = prevMonthLastDay - i;
            const prevDayName = new Date(year, month - 1, day).toLocaleString("default", {
                weekday: "short",
            });
            calendarGrid.innerHTML += `
            <div class="w-[118px] h-[82px] border rounded-xl p-2 bg-[#EBF2F7]/40 text-gray-400">
                <p class="text-xs font-medium">${prevDayName}</p>
                <p class="text-sm font-semibold">${day}</p>
            </div>`;
        }

        // Current month days
        for (let i = 1; i <= Math.min(daysInMonth, totalCells - startDay); i++) {
            const current = new Date(year, month, i);
            const isToday = current.toDateString() === new Date().toDateString();
            const dayName = current.toLocaleString("default", { weekday: "short" });

            calendarGrid.innerHTML += `
  <div onclick="showDayTimeline('${year}-${String(month + 1).padStart(2, "0")}-${String(i).padStart(
                2,
                "0"
            )}')"
       class="w-[118px] h-[82px] border rounded-xl p-2 bg-[#EBF2F7] ${
           isToday ? "ring-2 ring-[#54B7C5] bg-[white]" : ""
       } shadow-md cursor-pointer hover:bg-blue-100 transition">
      <p class="text-xs text-gray-500 font-medium">${dayName}</p>
      <p class="text-sm font-semibold text-gray-800">${i}</p>
  </div>`;
        }

        // Next month's days to fill remaining cells
        const renderedCurrent = Math.min(daysInMonth, totalCells - startDay);
        const nextDays = totalCells - (startDay + renderedCurrent);

        for (let i = 1; i <= nextDays; i++) {
            const dayName = new Date(year, month + 1, i).toLocaleString("default", {
                weekday: "short",
            });

            calendarGrid.innerHTML += `
            <div class="w-[125px] h-[87px] border rounded-xl p-2 bg-[#EBF2F7]/40 text-gray-400">
                <p class="text-xs font-medium">${dayName}</p>
                <p class="text-sm font-semibold">${i}</p>
            </div>`;
        }
    }

    prevBtn.addEventListener("click", () => {
        currentDate.setMonth(currentDate.getMonth() - 1);
        renderCalendar(currentDate);
    });

    nextBtn.addEventListener("click", () => {
        currentDate.setMonth(currentDate.getMonth() + 1);
        renderCalendar(currentDate);
    });

    renderCalendar(currentDate);

    const events = [
        { date: "2024-02-04", times: ["10:00 - 12:00", "14:00 - 16:00"] },
        { date: "2024-02-06", times: ["15:00 - 16:00"] },
        { date: "2024-02-07", times: ["14:00 - 16:00"] },
        { date: "2024-02-08", times: ["11:00 - 13:00", "13:30 - 16:30", "17:00 - 18:00"] },
        { date: "2024-02-09", times: ["16:00 - 18:00"] },
    ];

    function renderEvents() {
        const container = document.getElementById("event-list");
        container.innerHTML = "";
        events.forEach((event) => {
            const el = document.createElement("div");
            el.className =
                "rounded-lg p-3 border border-transparent bg-[#EBF2F7] text-gray-700 shadow-sm hover:border-[#54B7C5] cursor-pointer transition-all duration-200 text-sm";

            el.innerHTML = `
    <div class="flex items-start justify-between">
      <div>
        <p class="text-xs text-gray-500 font-medium">${new Date(event.date).toLocaleDateString(
            "en-US",
            { weekday: "short" }
        )}</p>
        <p class="text-xl font-bold">${new Date(event.date).getDate()}</p>
      </div>
    </div>
    <div class="mt-2 space-y-1">
      ${event.times
          .map(
              (time) => `
        <a href="#" class="flex items-center gap-2 text-[#163F75] hover:underline">
          <img src="<%= process.env.APP_URL_ADMIN %>/Icons/icons/TimeCircle.svg" alt="icon" class="w-4 h-4" />
          <span>${time}</span>
        </a>
      `
          )
          .join("")}
    </div>
  `;

            document.getElementById("event-list").appendChild(el);
        });
    }

    renderEvents();

    // === Day View Logic ===

    let selectedDay = null;

    // Switch to day timeline view
    function showDayTimeline(dateStr) {
        selectedDay = new Date(dateStr);
        document.getElementById("calendar-grid").classList.add("hidden");
        document.getElementById("day-timeline-view").classList.remove("hidden");

        renderDayTimeline();
    }

    // Go back to calendar
    function goBackToCalendar() {
        document.getElementById("calendar-grid").classList.remove("hidden");
        document.getElementById("day-timeline-view").classList.add("hidden");
    }

    // Render timeline for selectedDay
    function renderDayTimeline() {
        const container = document.getElementById("timeline-container");
        const header = document.getElementById("current-day-title");
        container.innerHTML = "";

        // Format date header
        const options = { weekday: "long", day: "numeric", year: "numeric", month: "long" };
        header.textContent = selectedDay.toLocaleDateString("en-US", options);

        const timeSlots = [
            "9 AM",
            "10 AM",
            "11 AM",
            "12 PM",
            "1 PM",
            "2 PM",
            "3 PM",
            "4 PM",
            "5 PM",
        ];

        // Render time slots
        timeSlots.forEach((slot) => {
            const div = document.createElement("div");
            div.className = "flex items-start border-t border-gray-200 h-[60px]";
            div.innerHTML = `
            <div class="w-[50px] text-right pr-2 text-xs text-gray-500 mt-[-10px]">${slot}</div>
            <div class="flex-1 h-full"></div>
        `;
            container.appendChild(div);
        });

        // Filter events for selected date
        const eventData = events.find((e) => e.date === selectedDay.toISOString().split("T")[0]);
        if (eventData) {
            eventData.times.forEach((time) => {
                const [start, end] = time.split(" - ");
                const el = document.createElement("div");
                el.className =
                    "absolute left-[60px] right-4 bg-white border-l-4 border-blue-500 shadow p-2 rounded text-sm";
                el.style.top = `${getEventTop(start)}%`;
                el.style.height = `${getEventHeight(start, end)}%`;
                el.innerHTML = `
                <div class="text-xs text-gray-500">${time}</div>
                <div class="font-medium text-gray-700">Dining Room, Kitchen</div>
            `;
                container.appendChild(el);
            });
        }
    }

    // Time utilities
    function getEventTop(startTime) {
        const [h, m] = startTime.split(":").map(Number);
        return ((h * 60 + m - 540) / 480) * 100; // offset from 9AM
    }
    function getEventHeight(start, end) {
        const [h1, m1] = start.split(":").map(Number);
        const [h2, m2] = end.split(":").map(Number);
        return ((h2 * 60 + m2 - (h1 * 60 + m1)) / 480) * 100;
    }

    // Day nav buttons
    function goToPreviousDay() {
        selectedDay.setDate(selectedDay.getDate() - 1);
        renderDayTimeline();
    }
    function goToNextDay() {
        selectedDay.setDate(selectedDay.getDate() + 1);
        renderDayTimeline();
    }
</script>
