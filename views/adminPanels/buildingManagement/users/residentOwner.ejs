<div
    class="bg-white rounded-tl-[40px] rounded-br-[90px] p-6 shadow-md flex justify-between items-center"
>
    <h1 class="text-2xl font-medium text-gray-500">Users</h1>
    <div class="flex items-center gap-4">
        <!-- Tab Buttons -->
        <div class="bg-[#F3F2F1] rounded-lg flex items-center">
            <button
                onclick="window.location.href='<%= process.env.APP_URL_ADMIN %>/bmadmin/users/residentowner'"
                id="btn-resident"
                class="px-4 py-2 rounded-lg text-white bg-[#54B7C5] transition-all"
            >
                Resident/Owner
            </button>
            <button
                onclick="window.location.href='<%= process.env.APP_URL_ADMIN %>/bmadmin/users/security'"
                id="btn-security"
                class="px-4 py-2 rounded-lg text-gray-600 hover:text-black transition-all"
            >
                Security
            </button>
            <button
                onclick="window.location.href='<%= process.env.APP_URL_ADMIN %>/bmadmin/users/technician'"
                id="btn-technician"
                class="px-4 py-2 rounded-lg text-gray-600 hover:text-black transition-all"
            >
                Technician
            </button>
        </div>

        <!-- File icon at the start -->
        <button
            class="flex items-center m-2 mr-5"
            data-modal-target="reports-modal"
            data-modal-toggle="reports-modal"
        >
            <svg
                class="w-6 h-6 text-gray-800 transform scale-x-[-1]"
                aria-hidden="true"
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                fill="none"
                viewBox="0 0 24 24"
            >
                <path
                    stroke="#163f75"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M10 3v4a1 1 0 0 1-1 1H5m4 8h6m-6-4h6m4-8v16a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V7.914a1 1 0 0 1 .293-.707l3.914-3.914A1 1 0 0 1 9.914 3H18a1 1 0 0 1 1 1Z"
                />
            </svg>
        </button>
    </div>
</div>

<div class="p-7">
    <div class="gap-4 py-2 px-4 items-center mb-3">
        <!-- Request Type Buttons -->
        <div class="flex justify-end items-center space-x-3">
            <div class="relative">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <svg
                        class="h-5 w-5 text-gray-400"
                        fill="none"
                        viewBox="0 0 24 24"
                        stroke="currentColor"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                        />
                    </svg>
                </div>
                <input
                    type="text"
                    placeholder="Search"
                    class="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg bg-white shadow-sm focus:outline-none focus:ring-1 focus:ring-[#54B7C5] focus:border-[#54B7C5] sm:text-sm"
                />
            </div>
            <button
                class="bg-white text-sm font-semibold text-[#163F75] border border-[2px] border-gray-300 px-8 py-2.5 rounded-xl hover:bg-[#163F75]/10 transition"
                data-modal-target="add-user-modal"
                data-modal-toggle="add-user-modal"
            >
                + Add Resident/Owner
            </button>
        </div>
    </div>
    <!-- DataTable Section -->
    <div class="overflow-x-auto">
        <table id="usersTable" class="min-w-full" datatables="true">
            <thead class="bg-[#EAEAE9] rounded-t-[30px]">
                <tr>
                    <th
                        class="px-6 py-3 text-left text-xs font-medium text-black uppercase tracking-wider first:rounded-l-lg last:rounded-r-lg"
                    >
                        <input
                            id="checkbox-all"
                            aria-describedby="checkbox-1"
                            type="checkbox"
                            class="w-4 h-4 border-gray-300 rounded bg-gray-50"
                        />
                    </th>
                    <th
                        class="px-6 py-3 text-left text-xs font-medium text-black uppercase tracking-wider"
                    >
                        Flat/Villa
                    </th>
                    <th
                        class="px-6 py-3 text-left text-xs font-medium text-black uppercase tracking-wider"
                    >
                        Building/Complex
                    </th>
                    <th
                        class="px-6 py-3 text-left text-xs font-medium text-black uppercase tracking-wider first:rounded-l-lg last:rounded-r-lg"
                    >
                        User Name
                    </th>
                    <th
                        class="px-6 py-3 text-left text-xs font-medium text-black uppercase tracking-wider"
                    >
                        ID No.
                    </th>
                    <th
                        class="px-6 py-3 text-left text-xs font-medium text-black uppercase tracking-wider"
                    >
                        Nationality
                    </th>
                    <th
                        class="px-6 py-3 text-left text-xs font-medium text-black uppercase tracking-wider"
                    >
                        Contact No.
                    </th>
                    <th
                        class="px-6 py-3 text-left text-xs font-medium text-black uppercase tracking-wider"
                    >
                        Emergency No.
                    </th>
                    <th
                        class="px-6 py-3 text-left text-xs font-medium text-black uppercase tracking-wider"
                    >
                        Property
                    </th>
                    <th
                        class="px-6 py-3 text-left text-xs font-medium text-black uppercase tracking-wider"
                    >
                        Ownership
                    </th>
                    <th
                        class="px-6 py-3 text-left text-xs font-medium text-black uppercase tracking-wider"
                    >
                        Association
                    </th>
                    <th
                        class="px-6 py-3 text-left text-xs font-medium text-black uppercase tracking-wider"
                    >
                        Agreement
                    </th>
                    <th
                        class="px-6 py-3 text-left text-xs font-medium text-black uppercase tracking-wider last:rounded-r-lg"
                    >
                        Actions
                    </th>
                </tr>
            </thead>
            <tbody class="divide-y divide-gray-200">
                <!-- User 1 -->
                <tr>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                        <input
                            id="checkbox-all"
                            aria-describedby="checkbox-1"
                            type="checkbox"
                            class="w-4 h-4 border-gray-300 rounded bg-gray-200 appearance-none checked:bg-[#54B7C5] focus:ring-[#54B7C5]"
                        />
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">123 - Flat</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        Marasai Residences
                    </td>
                    <td class="flex items-center p-4 mr-12 space-x-1 whitespace-nowrap">
                        <img
                            class="w-10 h-10 rounded-full"
                            src="https://flowbite-admin-dashboard.vercel.app/images/users/neil-sims.png"
                            alt="Neil Sims avatar"
                        />
                        <div class="text-base font-semibold text-gray-900">Neil Sims</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">123456789</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">USA</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">+773 39876543</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">+773 39876543</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Resident</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Owner</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Member</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"></td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        <button
                            type="button"
                            data-modal-target="delete-user-modal"
                            data-modal-toggle="delete-user-modal"
                            class="inline-flex items-center px-3 py-2"
                        >
                            <svg
                                class="w-6 h-6 text-gray-800 dark:text-white"
                                aria-hidden="true"
                                xmlns="http://www.w3.org/2000/svg"
                                width="24"
                                height="24"
                                fill="none"
                                viewBox="0 0 24 24"
                            >
                                <path
                                    stroke="#F26E6E"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    stroke-width="2"
                                    d="M5 7h14m-9 3v8m4-8v8M10 3h4a1 1 0 0 1 1 1v3H9V4a1 1 0 0 1 1-1ZM6 7h12v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7Z"
                                />
                            </svg>
                        </button>
                        <button
                            type="button"
                            data-modal-target="edit-user-modal"
                            data-modal-toggle="edit-user-modal"
                            class="inline-flex items-center"
                        >
                            <svg
                                class="w-6 h-6 text-gray-800 dark:text-white"
                                aria-hidden="true"
                                xmlns="http://www.w3.org/2000/svg"
                                width="24"
                                height="24"
                                fill="none"
                                viewBox="0 0 24 24"
                            >
                                <path
                                    stroke="#54B7C5"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    stroke-width="2"
                                    d="m14.304 4.844 2.852 2.852M7 7H4a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h11a1 1 0 0 0 1-1v-4.5m2.409-9.91a2.017 2.017 0 0 1 0 2.853l-6.844 6.844L8 14l.713-3.565 6.844-6.844a2.015 2.015 0 0 1 2.852 0Z"
                                />
                            </svg>
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>

        <!-- Pagination Info -->
        <div class="mt-4 text-sm text-gray-600 px-6">Showing 1 of 28</div>
    </div>
</div>

<!-- add User Details Modal -->
<div
    id="add-user-modal"
    tabindex="-1"
    class="fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto h-modal md:h-full"
    aria-hidden="true"
>
    <div class="bg-[#F7F6F5] rounded-2xl shadow-xl w-full max-w-md">
        <div class="flex justify-between items-center p-6 border-b border-gray-200">
            <h3 class="text-xl font-semibold text-gray-800">Add Resident/Owner</h3>
            <button
                data-modal-hide="add-user-modal"
                class="text-red-400 hover:text-red-600 text-2xl"
            >
                Close &times;
            </button>
        </div>
        <form id="add-users-form" method="post" enctype="multipart/form-data">
            <div class="p-6">
                <div class="flex justify-center mb-6">
                    <div class="relative w-24 h-24">
                        <div
                            id="profilePlaceholder"
                            class="w-[95px] h-[95px] rounded-full border-4 border-[#57C1D1] flex items-center justify-center bg-gray-100 overflow-hidden"
                        >
                            <svg
                                class="w-10 h-10 text-gray-500"
                                xmlns="http://www.w3.org/2000/svg"
                                fill="none"
                                viewBox="0 0 24 24"
                                stroke="currentColor"
                                stroke-width="2"
                            >
                                <path
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    d="M7 17v1a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1v-1a3 3 0 0 0-3-3h-4a3 3 0 0 0-3 3Zm8-9a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"
                                />
                            </svg>
                        </div>
                        <input
                            id="imageUpload"
                            name="personalPhoto"
                            type="file"
                            accept="image/*"
                            class="hidden"
                        />
                        <label
                            for="imageUpload"
                            class="absolute bottom-0 right-0 bg-[#57C1D1] text-white p-2 rounded-full shadow-[0px_4px_10px_rgba(0,0,0,0.05)] cursor-pointer"
                        >
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                class="h-4 w-4"
                                fill="none"
                                viewBox="0 0 24 24"
                                stroke="currentColor"
                            >
                                <path
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    stroke-width="2"
                                    d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"
                                />
                                <path
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    stroke-width="2"
                                    d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"
                                />
                            </svg>
                        </label>
                    </div>
                </div>
                <div class="space-y-5">
                    <div class="">
                        <input
                            name="fullName"
                            type="text"
                            placeholder="Full Name"
                            class="w-full px-4 py-3 bg-white rounded-xl text-gray-700 text-sm focus:outline-none placeholder-gray-500 shadow-[0px_4px_10px_rgba(0,0,0,0.05)]"
                        />
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <input
                            name="IDno"
                            type="text"
                            placeholder="ID No."
                            class="w-full px-4 py-3 bg-white rounded-xl text-gray-700 text-sm focus:outline-none placeholder-gray-500 shadow-[0px_4px_10px_rgba(0,0,0,0.05)]"
                        />
                        <div>
                            <select
                                name="nationality"
                                class="w-full px-4 py-3 bg-white rounded-xl text-gray-700 text-sm focus:outline-none placeholder-gray-500 shadow-[0px_4px_10px_rgba(0,0,0,0.05)]"
                            >
                                <option value="" disabled selected>Nationality</option>
                                <option value="Bahrain">Bahrain</option>
                                <option value="Saudi Arabia">Saudi Arabia</option>
                                <option value="UAE">UAE</option>
                                <option value="Qatar">Qatar</option>
                                <option value="Kuwait">Kuwait</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <select
                            name="buildingOrComplexName"
                            class="w-full px-4 py-3 bg-white rounded-xl text-gray-700 text-sm focus:outline-none placeholder-gray-500 shadow-[0px_4px_10px_rgba(0,0,0,0.05)]"
                        >
                            <option value="" disabled selected>Building/Complex Name</option>
                            <% buildingOrComplex.forEach(b => { %>
                            <option value="<%= b._id %>"><%= b.buildingNameOrAreaName %></option>
                            <% }) %>
                        </select>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <input
                            name="flatVillaNumber"
                            type="text"
                            placeholder="Flat/Villa"
                            class="w-full px-4 py-3 bg-white rounded-xl text-gray-700 text-sm focus:outline-none placeholder-gray-500 shadow-[0px_4px_10px_rgba(0,0,0,0.05)]"
                        />

                        <div
                            class="flex items-center px-4 py-3 bg-white rounded-xl shadow-[0px_4px_10px_rgba(0,0,0,0.05)]"
                        >
                            <input
                                name="associationMember"
                                id="associationMember"
                                type="checkbox"
                                class="w-4 h-4 text-[#57C1D1] focus:ring-[#57C1D1] border border-gray-300 rounded"
                            />
                            <label for="associationMember" class="ml-2 text-sm text-gray-700">
                                Association Member
                            </label>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div
                            class="flex items-center px-4 py-3 bg-white rounded-xl shadow-[0px_4px_10px_rgba(0,0,0,0.05)]"
                        >
                            <input
                                name="resident"
                                id="resident"
                                type="checkbox"
                                class="w-4 h-4 text-[#57C1D1] focus:ring-[#57C1D1] border border-gray-300 rounded"
                            />
                            <label for="resident" class="ml-2 text-sm text-gray-700">
                                Resident
                            </label>
                        </div>

                        <div
                            class="flex items-center px-4 py-3 bg-white rounded-xl shadow-[0px_4px_10px_rgba(0,0,0,0.05)]"
                        >
                            <input
                                name="owner"
                                id="owner"
                                type="checkbox"
                                class="w-4 h-4 text-[#57C1D1] focus:ring-[#57C1D1] border border-gray-300 rounded"
                            />
                            <label for="owner" class="ml-2 text-sm text-gray-700">Owner</label>
                        </div>
                    </div>
                    <div
                        class="flex items-center px-4 py-3 bg-white rounded-xl shadow-[0px_4px_10px_rgba(0,0,0,0.05)]"
                    >
                        <div class="relative flex items-center mr-3">
                            <select
                                name="countryCode1"
                                class="z-10 absolute inset-0 w-full h-full opacity-0 cursor-pointer"
                                onchange="updateFlag(this)"
                                data-flag-id="contact-no-flag"
                                data-code-id="contact-no-code"
                            >
                                <% countries.forEach((country, index) => { %>
                                <!-- <option 
                                            value="<%= country.countryCode %>" 
                                            data-flag="<%= country.flag %>"
                                            <%= index === 0 ? 'selected' : '' %>
                                        >
                                            <%= country.countryCode %> <%= country.name %>
                                        </option> -->
                                <% }) %>
                            </select>

                            <img
                                id="contact-no-flag"
                                src="<%= countries[0]?.flag %>"
                                class="w-10 h-6 object-cover border rounded-sm z-0"
                                alt="Country flag"
                            />

                            <svg
                                class="w-2.5 h-2.5 text-gray-600 ml-1 pointer-events-none"
                                fill="none"
                                viewBox="0 0 10 6"
                            >
                                <path stroke="currentColor" stroke-width="2" d="M1 1l4 4 4-4" />
                            </svg>
                        </div>
                        <input
                            name="contactNumber"
                            type="text"
                            placeholder="Contact Number"
                            class="w-full bg-transparent focus:outline-none text-sm placeholder-gray-400"
                        />
                    </div>
                    <div
                        class="flex items-center px-4 py-3 bg-white rounded-xl shadow-[0px_4px_10px_rgba(0,0,0,0.05)]"
                    >
                        <div class="relative flex items-center mr-3">
                            <select
                                name="countryCode2"
                                class="z-10 absolute inset-0 w-full h-full opacity-0 cursor-pointer"
                                onchange="updateFlag(this)"
                                data-flag-id="emergency-no-flag"
                                data-code-id="emergency-no-code"
                            >
                                <% countries.forEach((country, index) => { %>
                                <!-- <option 
                                            value="<%= country.countryCode %>" 
                                            data-flag="<%= country.flag %>"
                                            <%= index === 0 ? 'selected' : '' %>
                                        >
                                            <%= country.countryCode %> <%= country.name %>
                                        </option> -->
                                <% }) %>
                            </select>

                            <img
                                id="emergency-no-flag"
                                src="<%= countries[0]?.flag %>"
                                class="w-10 h-6 object-cover border rounded-sm z-0"
                                alt="Country flag"
                            />

                            <svg
                                class="w-2.5 h-2.5 text-gray-600 ml-1 pointer-events-none"
                                fill="none"
                                viewBox="0 0 10 6"
                            >
                                <path stroke="currentColor" stroke-width="2" d="M1 1l4 4 4-4" />
                            </svg>
                        </div>
                        <input
                            name="emergencyNumber"
                            type="text"
                            placeholder="Emergency Number"
                            class="w-full bg-transparent focus:outline-none text-sm placeholder-gray-400"
                        />
                    </div>
                </div>
                <div class="flex items-center justify-center mt-4">
                    <label
                        class="flex items-center justify-center w-full h-16 bg-white border border-dashed border-gray-300 rounded-xl cursor-pointer shadow-[0px_4px_10px_rgba(0,0,0,0.05)]"
                    >
                        <div class="flex items-center gap-2 text-sm text-gray-500">
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                class="w-5 h-5 text-gray-500"
                                fill="none"
                                viewBox="0 0 24 24"
                                stroke="currentColor"
                            >
                                <path
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    stroke-width="2"
                                    d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4-4m0 0l-4 4m4-4v12"
                                />
                            </svg>
                            <span>Please Upload Agreement Here (PDF)</span>
                        </div>
                        <input name="agreementPdf" type="file" class="hidden" />
                    </label>
                </div>
                <div class="flex justify-center p-6 border-t border-gray-200">
                    <button
                        type="submit"
                        class="bg-[#57C1D1] hover:bg-[#4BB3C2] text-white py-3 px-9 rounded-lg font-medium text-base shadow-[0px_4px_10px_rgba(0,0,0,0.05)] transition"
                    >
                        Save
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>

<!-- Reports Modal -->
<div
    id="reports-modal"
    tabindex="-1"
    class="fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto h-modal md:h-full"
    aria-hidden="true"
>
    <!-- Modal Container -->
    <div class="bg-[#F7F6F5] rounded-2xl shadow-xl w-full max-w-md">
        <!-- Modal Header -->
        <div class="flex justify-between items-center p-6 border-b border-gray-200">
            <h3 class="text-xl font-semibold text-gray-800">Reports</h3>
            <button
                data-modal-hide="reports-modal"
                class="text-red-400 hover:text-red-600 text-2xl"
            >
                Close &times;
            </button>
        </div>

        <!-- Modal Content -->
        <div class="p-6">
            <div class="flex flex-col space-y-3">
                <div class="relative">
                    <label class="block text-sm font-medium text-gray-700 mb-1">From</label>
                    <div class="relative">
                        <div
                            class="absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none"
                        >
                            <svg
                                class="w-4 h-4 text-gray-500"
                                aria-hidden="true"
                                xmlns="http://www.w3.org/2000/svg"
                                fill="currentColor"
                                viewBox="0 0 20 20"
                            >
                                <path
                                    d="M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"
                                />
                            </svg>
                        </div>
                        <input
                            datepicker
                            datepicker-orientation="bottom"
                            datepicker-format="dd-mm-yyyy"
                            type="text"
                            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full ps-10 p-2.5"
                            placeholder="Select date"
                        />
                    </div>
                </div>

                <div class="relative">
                    <label class="block text-sm font-medium text-gray-700 mb-1">To</label>
                    <div class="relative">
                        <div
                            class="absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none"
                        >
                            <svg
                                class="w-4 h-4 text-gray-500"
                                aria-hidden="true"
                                xmlns="http://www.w3.org/2000/svg"
                                fill="currentColor"
                                viewBox="0 0 20 20"
                            >
                                <path
                                    d="M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"
                                />
                            </svg>
                        </div>
                        <input
                            datepicker
                            datepicker-orientation="bottom"
                            datepicker-format="dd-mm-yyyy"
                            type="text"
                            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full ps-10 p-2.5"
                            placeholder="Select date"
                        />
                    </div>
                </div>
            </div>

            <!-- Modal Footer -->
            <div class="flex justify-center p-6 gap-2 border-gray-200">
                <button
                    class="bg-[#57C1D1] hover:bg-[#4BB3C2] text-white py-3 px-16 rounded-lg font-medium text-base shadow-[0px_4px_10px_rgba(0,0,0,0.05)] transition"
                >
                    View
                </button>
                <button
                    class="bg-[#163F75] hover:bg-[#163F75]/90 text-white py-3 px-16 rounded-lg font-medium text-base shadow-[0px_4px_10px_rgba(0,0,0,0.05)] transition"
                >
                    Extract
                </button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.min.css" />
<script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
    function updateFlag(selectEl) {
        const selectedOption = selectEl.options[selectEl.selectedIndex];
        const flagUrl = selectedOption.dataset.flag;
        const countryCode = selectedOption.value;

        const flagImgId = selectEl.dataset.flagId;
        const codeSpanId = selectEl.dataset.codeId;

        if (flagImgId && flagUrl) {
            const flagImg = document.getElementById(flagImgId);
            if (flagImg) flagImg.src = flagUrl;
        }

        if (codeSpanId) {
            const codeSpan = document.getElementById(codeSpanId);
            if (codeSpan) codeSpan.innerText = countryCode;
        }
    }

    const imageUpload = document.getElementById("imageUpload");
    const profilePlaceholder = document.getElementById("profilePlaceholder");

    imageUpload.addEventListener("change", function () {
        const file = this.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function (e) {
                profilePlaceholder.innerHTML = `
          <img src="${e.target.result}" alt="Profile" class="w-full h-full object-cover rounded-full" />
        `;
            };
            reader.readAsDataURL(file);
        }
    });

    $("#add-users-form").on("submit", function (e) {
        console.log("form submited");
        e.preventDefault();
        const form = new FormData(this);
        $.ajax({
            type: "POST",
            url: "/bmadmin/users/residentowner",
            data: form,
            processData: false,
            contentType: false,
            success: function (response) {
                if (response.success) {
                    window.location.href = `/bmadmin/users/residentowner`;
                    Swal.fire({
                        icon: "success",
                        title: "Success",
                        text: response.message,
                        toast: true,
                        position: "top-end",
                        showConfirmButton: false,
                        timer: 3000,
                        timerProgressBar: true,
                    });
                }
            },
            error: function (err) {
                console.error(err);
                Swal.fire({
                    icon: "error",
                    title: "Error",
                    text: err.message,
                    toast: true,
                    position: "top-end",
                    showConfirmButton: false,
                    timer: 3000,
                    timerProgressBar: true,
                });
            },
        });
    });

    $(document).ready(function () {
        if ($.fn.DataTable) {
            $("#usersTable").DataTable({
                paging: true,
                searching: true,
                info: true,
                lengthMenu: [
                    [10, 25, 50, -1],
                    [10, 25, 50, "All"],
                ],
                pageLength: 10,
                order: [[0, "desc"]],
                responsive: true,
                ordering: true,
                serverSide: true,
                processing: true,
                ajax: {
                    url: "/bmadmin/users/residentowner/list",
                    type: "GET",
                },
                columns: [
                    {
                        data: flatVillaNumber,
                        class: "px-6 py-4 whitespace-nowrap text-sm text-gray-900",
                    },
                    {
                        data: buildingOrComplexName,
                        class: "px-6 py-4 whitespace-nowrap text-sm text-gray-900",
                        render: function (data) {
                            if ("<%= buildingOrComplex._id %>" === data.buildingOrComplexName) {
                                return "<%= buildingOrComplex.buildingNameOrAreaName %>";
                            } else {
                                return "N/A";
                            }
                        },
                    },
                    {
                        data: null,
                        class: "flex items-center p-4 mr-12 space-x-1 whitespace-nowrap",
                        render: function (data, type, row) {
                            const name = row.fullName || "N/A";
                            const photoUrl = row.personalPhoto
                                ? row.personalPhoto
                                : "/images/default-user.png";
                            return `
                                <div>
                                    <img src="${photoUrl}" alt="${name}" class="w-10 h-10 rounded-full" />
                                            <span class="text-base font-semibold text-gray-900">${name}</span>
                                </div>
                            `;
                        },
                    },
                    {
                        data: IDno,
                        class: "px-6 py-4 whitespace-nowrap text-sm text-gray-900",
                    },
                    {
                        data: nationality,
                        class: "flex items-center p-4 mr-12 space-x-1 whitespace-nowrap",
                        render: function (data, type, row) {
                            if ("<%= countires.name %>" === data.nationality) {
                                return ` <img
                                src="<%= countries.flag %>"
                                class="w-10 h-6 object-cover border rounded-sm z-0"
                                alt="Country flag"
                            />`;
                            }
                        },
                    },
                    {
                        data: null,
                        class: "px-6 py-4 whitespace-nowrap text-sm text-gray-900",
                        render: function (data, row, type) {
                            const code = row.countryCode1;
                            const num = row.contactNumber;
                            return code + " " + num;
                        },
                    },
                    {
                        data: null,
                        class: "px-6 py-4 whitespace-nowrap text-sm text-gray-900",
                        render: function (data, row, type) {
                            const code = row.countryCode2;
                            const emnum = row.emergencyNumber;
                            return code + " " + emnum;
                        },
                    },
                    {
                        data: resident,
                        class: "px-6 py-4 whitespace-nowrap text-sm text-gray-900",
                    },
                    {
                        data: owner,
                        class: "px-6 py-4 whitespace-nowrap text-sm text-gray-900",
                    },
                    {
                        data: associationMember,
                        class: "px-6 py-4 whitespace-nowrap text-sm text-gray-900",
                    },
                    {
                        data: agreementPdf,
                        class: "px-6 py-4 whitespace-nowrap text-sm text-gray-900",
                    },
                    {
                        data: null,
                        class: "px-6 py-4 whitespace-nowrap text-sm text-gray-900",
                        render: function (data, row, type) {
                            return `<button
                            type="button"
                            data-modal-target="delete-user-modal"
                            data-modal-toggle="delete-user-modal"
                            class="inline-flex items-center px-3 py-2"
                        >
                            <svg
                                class="w-6 h-6 text-gray-800 dark:text-white"
                                aria-hidden="true"
                                xmlns="http://www.w3.org/2000/svg"
                                width="24"
                                height="24"
                                fill="none"
                                viewBox="0 0 24 24"
                            >
                                <path
                                    stroke="#F26E6E"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    stroke-width="2"
                                    d="M5 7h14m-9 3v8m4-8v8M10 3h4a1 1 0 0 1 1 1v3H9V4a1 1 0 0 1 1-1ZM6 7h12v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7Z"
                                />
                            </svg>
                        </button>
                        <button
                            type="button"
                            data-modal-target="edit-user-modal"
                            data-modal-toggle="edit-user-modal"
                            class="inline-flex items-center"
                        >
                            <svg
                                class="w-6 h-6 text-gray-800 dark:text-white"
                                aria-hidden="true"
                                xmlns="http://www.w3.org/2000/svg"
                                width="24"
                                height="24"
                                fill="none"
                                viewBox="0 0 24 24"
                            >
                                <path
                                    stroke="#54B7C5"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    stroke-width="2"
                                    d="m14.304 4.844 2.852 2.852M7 7H4a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h11a1 1 0 0 0 1-1v-4.5m2.409-9.91a2.017 2.017 0 0 1 0 2.853l-6.844 6.844L8 14l.713-3.565 6.844-6.844a2.015 2.015 0 0 1 2.852 0Z"
                                />
                            </svg>
                        </button>`;
                        },
                    },
                ],
                columnDefs: [
                    {
                        targets: "_all",
                        className: "text-center",
                    },
                ],
            });
        } else {
            console.error("DataTables is not loaded");
        }
    });
</script>
